# –ê–Ω–∞–ª–∏–∑ —Ñ–æ–Ω–¥–æ–≤ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 1:*** *–ó–∞–∫—Ä—ã—Ç—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã company –ø–æ –∫–æ–º–ø–∞–Ω–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫—Ä—ã–ª–∏—Å—å.

```sql
SELECT *
FROM company
WHERE status = 'closed';
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 2:*** *–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –Ω–æ–≤–æ—Å—Ç–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ –°–®–ê*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –°–®–ê. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `company`. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É–ø–æ —É–±—ã–≤–∞–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–π –≤ –ø–æ–ª–µ `funding_total`.

```sql
SELECT funding_total
FROM company
WHERE country_code = 'USA' AND category_code = 'news'
ORDER BY funding_total DESC;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 3:*** *–°—É–º–º–∞ —Å–¥–µ–ª–æ–∫ –∑–∞ –Ω–∞–ª–∏—á–Ω—ã–µ (2011‚Äì2013)*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–∞–π–¥–∏—Ç–µ –æ–±—â—É—é —Å—É–º–º—É —Å–¥–µ–ª–æ–∫ –ø–æ –ø–æ–∫—É–ø–∫–µ –æ–¥–Ω–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π –¥—Ä—É–≥–∏–º–∏ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö. –û—Ç–±–µ—Ä–∏—Ç–µ —Å–¥–µ–ª–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –∑–∞ –Ω–∞–ª–∏—á–Ω—ã–µ —Å 2011 –ø–æ 2013 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ.

```sql
SELECT SUM(price_amount)
FROM acquisition
WHERE term_code = 'cash' AND EXTRACT(YEAR FROM CAST(acquired_at AS date)) BETWEEN 2011 AND 2013;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 4:*** *–ê–∫–∫–∞—É–Ω—Ç—ã, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ 'Silver'*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –∏–º—è, —Ñ–∞–º–∏–ª–∏—é –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ª—é–¥–µ–π –≤ –ø–æ–ª–µ `network_username`, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –Ω–∞ 'Silver'.  

```sql
SELECT first_name, last_name, network_username
FROM people
WHERE network_username LIKE 'Silver%';
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 5:*** *–ê–∫–∫–∞—É–Ω—Ç—ã —Å 'money' –∏ —Ñ–∞–º–∏–ª–∏–µ–π –Ω–∞ 'K'*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–≤–µ–¥–∏—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª—é–¥—è—Ö, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –≤ –ø–æ–ª–µ `network_username` —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–¥—Å—Ç—Ä–æ–∫—É 'money', –∞ `last_name` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ 'K'.  

```sql
SELECT *
FROM people
WHERE network_username LIKE '%money%' AND last_name LIKE 'K%';
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 6:*** *–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–µ. –°—Ç—Ä–∞–Ω—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è, –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ –∫–æ–¥—É –≤ –ø–æ–ª–µ `country_code`. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—É–º–º—ã.  

```sql
SELECT country_code, SUM(funding_total)
FROM company
GROUP BY country_code
ORDER BY sum DESC;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 7:*** *–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –ø–æ –¥–∞—Ç–∞–º*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä—É—é –≤–æ–π–¥—ë—Ç `funded_at`, –∞ —Ç–∞–∫–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—É–º–º—ã –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –≤ —ç—Ç—É –¥–∞—Ç—É. –û—Å—Ç–∞–≤—å—Ç–µ –≤ –∏—Ç–æ–≥–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–ø–∏—Å–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—É–º–º—ã –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –Ω–µ —Ä–∞–≤–Ω–æ –Ω—É–ª—é –∏ –Ω–µ —Ä–∞–≤–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é.  

```sql
SELECT funded_at, MIN(raised_amount) AS min_ra, MAX(raised_amount) AS max_ra
FROM funding_round
GROUP BY funded_at
HAVING MIN(raised_amount) != 0 AND MIN(raised_amount) != MAX(raised_amount);
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 8:*** *–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ñ–æ–Ω–¥–æ–≤*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏:  
- –î–ª—è —Ñ–æ–Ω–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É—é—Ç –≤ 100 –∏ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–Ω–∏–π, –Ω–∞–∑–Ω–∞—á—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é `high_activity`.  
- –î–ª—è —Ñ–æ–Ω–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É—é—Ç –≤ 20 –∏ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–Ω–∏–π –¥–æ 100, –Ω–∞–∑–Ω–∞—á—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é `middle_activity`.  
- –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π —Ñ–æ–Ω–¥–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 20, –Ω–∞–∑–Ω–∞—á—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é `low_activity`.  

–û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `fund` –∏ –Ω–æ–≤–æ–µ –ø–æ–ª–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏.  

```sql
SELECT *, 
       CASE
           WHEN invested_companies >= 100 THEN 'high_activity'
           WHEN invested_companies >= 20 THEN 'middle_activity'
           ELSE 'low_activity'
       END
FROM fund;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 9:*** *–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ñ–æ–Ω–¥–æ–≤*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∑–∞–¥–∞–Ω–∏–∏, –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–∫—Ä—É–≥–ª—ë–Ω–Ω–æ–µ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ–Ω–¥ –ø—Ä–∏–Ω–∏–º–∞–ª —É—á–∞—Å—Ç–∏–µ. –í—ã–≤–µ–¥–∏—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Å—Ä–µ–¥–Ω–µ–≥–æ.  

```sql
SELECT CASE
           WHEN invested_companies>=100 THEN 'high_activity'
           WHEN invested_companies>=20 THEN 'middle_activity'
           ELSE 'low_activity'
       END AS activity,
       ROUND(AVG(investment_rounds)) AS avg_ir
FROM fund
GROUP BY activity
ORDER BY avg_ir ASC;
```

-------------------------
üîπ ***–ó–∞–¥–∞–Ω–∏–µ 10:*** *–°—Ç—Ä–∞–Ω—ã —Å –Ω–∞–∏–±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Ñ–æ–Ω–¥–∞–º–∏*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ, –≤ –∫–∞–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ñ–æ–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É—é—Ç –≤ —Å—Ç–∞—Ä—Ç–∞–ø—ã. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ –∫–æ–º–ø–∞–Ω–∏–π, –≤ –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ —Ñ–æ–Ω–¥—ã —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Å 2010 –ø–æ 2012 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ. –ò—Å–∫–ª—é—á–∏—Ç–µ —Å—Ç—Ä–∞–Ω—ã —Å —Ñ–æ–Ω–¥–∞–º–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∫–æ–º–ø–∞–Ω–∏–π, –ø–æ–ª—É—á–∏–≤—à–∏—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, —Ä–∞–≤–Ω–æ –Ω—É–ª—é.  
–í—ã–≥—Ä—É–∑–∏—Ç–µ –¥–µ—Å—è—Ç—å —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞–Ω-–∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤: –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–æ–º–ø–∞–Ω–∏–π –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É. –ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ –∫–æ–¥—É —Å—Ç—Ä–∞–Ω—ã –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ.  

```sql
SELECT country_code,
       MIN(invested_companies),
       MAX(invested_companies),
       AVG(invested_companies)
FROM fund
WHERE EXTRACT(YEAR FROM CAST(founded_at AS date)) BETWEEN 2010 AND 2012
GROUP BY country_code
HAVING MIN(invested_companies) != 0
ORDER BY AVG(invested_companies) DESC, country_code ASC
LIMIT 10;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 11:*** *–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤ –∏ –∏—Ö –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ `first_name` –∏ `last_name` –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É—á–µ–±–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è `education`, –∫–æ—Ç–æ—Ä–æ–µ –æ–∫–æ–Ω—á–∏–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫, –µ—Å–ª–∏ —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑–≤–µ—Å—Ç–Ω–∞.  

```sql
SELECT p.first_name, p.last_name, e.instituition
FROM people AS p
LEFT OUTER JOIN education AS e ON p.id = e.person_id;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 12:*** *–¢–æ–ø-5 –∫–æ–º–ø–∞–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–∫–æ–Ω—á–∏–ª–∏ –µ—ë —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏. –í—ã–≤–µ–¥–∏—Ç–µ `company_name` –∏ —á–∏—Å–ª–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π. –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ø-5 –∫–æ–º–ø–∞–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤.  

```sql
SELECT c.name,
       COUNT(DISTINCT e.instituition)
FROM company AS c
INNER JOIN people AS p ON p.company_id=c.id
INNER JOIN education AS e ON p.id=e.person_id
GROUP BY c.name
ORDER BY COUNT(e.instituition) DESC
LIMIT 5;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 13:*** *–ó–∞–∫—Ä—ã—Ç—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∞—É–Ω–¥–æ–º —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –æ–∫–∞–∑–∞–ª—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º.  

```sql
SELECT DISTINCT c.name
FROM funding_round AS fr
LEFT OUTER JOIN company AS c ON c.id = fr.company_id
WHERE fr.is_first_round = 1 AND fr.is_last_round = 1 AND c.status = 'closed';
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 14:*** *–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∞—É–Ω–¥–æ–º —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∫–æ–º–ø–∞–Ω–∏—è—Ö, –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∑–∞–¥–∞–Ω–∏–∏.  

```sql
SELECT DISTINCT id
FROM people
WHERE company_id IN (SELECT c.id
                   FROM funding_round AS fr
                   LEFT OUTER JOIN company AS c ON c.id = fr.company_id
                   WHERE fr.is_first_round = 1 AND fr.is_last_round = 1 AND c.status = 'closed');
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 15:*** *–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –∏ –∏—Ö —É—á–µ–±–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –∫—É–¥–∞ –≤–æ–π–¥—É—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–¥–∞—á–∏ –∏ —É—á–µ–±–Ω—ã–º –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ –æ–∫–æ–Ω—á–∏–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫.  

```sql
SELECT DISTINCT p.id,
       e.instituition
FROM people AS p
INNER JOIN education AS e ON p.id=e.person_id
INNER JOIN company AS c ON p.company_id=c.id
INNER JOIN funding_round AS fr ON c.id=fr.company_id
WHERE c.status = 'closed'
      AND fr.is_first_round = 1
      AND fr.is_last_round = 1;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 16:*** *–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –ü—Ä–∏ –ø–æ–¥—Å—á—ë—Ç–µ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –º–æ–≥–ª–∏ –æ–∫–æ–Ω—á–∏—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –¥–≤–∞–∂–¥—ã.  

```sql
SELECT p.id,
       COUNT(e.instituition)
FROM people AS p
INNER JOIN education AS e ON p.id=e.person_id
INNER JOIN company AS c ON p.company_id=c.id
WHERE c.status = 'closed'
      AND c.id IN (SELECT company_id
                   FROM funding_round
                   WHERE is_first_round = 1 AND is_last_round = 1)
GROUP BY p.id;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 17:*** *–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∑–∞–ø—Ä–æ—Å –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π (–≤—Å–µ—Ö, –Ω–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö), –∫–æ—Ç–æ—Ä—ã–µ –æ–∫–æ–Ω—á–∏–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π. –ù—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∑–∞–ø–∏—Å—å, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∑–¥–µ—Å—å –Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è.  

```sql
SELECT AVG(count) 
FROM (SELECT p.id,
       COUNT(e.instituition)
FROM people AS p
INNER JOIN education AS e ON p.id=e.person_id
INNER JOIN company AS c ON p.company_id=c.id
WHERE c.status = 'closed'
      AND c.id IN (SELECT company_id
                   FROM funding_round
                   WHERE is_first_round = 1 AND is_last_round = 1)
GROUP BY p.id) AS t;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 18:*** *–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ Socialnet*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π (–≤—Å–µ—Ö, –Ω–µ —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö), –∫–æ—Ç–æ—Ä—ã–µ –æ–∫–æ–Ω—á–∏–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ `Socialnet`.  

```sql
SELECT AVG(count)
FROM (SELECT COUNT(e.instituition)
FROM people AS p
INNER JOIN education AS e ON p.id=e.person_id
INNER JOIN company AS c ON p.company_id=c.id
WHERE c.name = 'Socialnet'
GROUP BY p.id) AS t;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 19:*** *–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ —Å —Ä–∞–∑–≤–∏—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Å—Ç–∞–≤—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∏–∑ –ø–æ–ª–µ–π:  
- `name_of_fund` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–æ–Ω–¥–∞;  
- `name_of_company` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏;  
- `amount` ‚Äî —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–∏–≤–ª–µ–∫–ª–∞ –∫–æ–º–ø–∞–Ω–∏—è –≤ —Ä–∞—É–Ω–¥–µ.

–í —Ç–∞–±–ª–∏—Ü—É –≤–æ–π–¥—É—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–º–ø–∞–Ω–∏—è—Ö, –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ—Ç–æ—Ä—ã—Ö –±—ã–ª–æ –±–æ–ª—å—à–µ —à–µ—Å—Ç–∏ –≤–∞–∂–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤, –∞ —Ä–∞—É–Ω–¥—ã —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Å 2012 –ø–æ 2013 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ.  

```sql
SELECT f.name AS name_of_fund, c.name AS name_of_company, fr.raised_amount AS amount
FROM fund AS f
LEFT OUTER JOIN investment AS i ON i.fund_id = f.id
LEFT OUTER JOIN company AS c ON i.company_id = c.id
LEFT OUTER JOIN funding_round AS fr ON fr.id = i.funding_round_id
WHERE c.milestones > 6
      AND
      EXTRACT(YEAR FROM CAST (fr.funded_at AS TIMESTAMP)) BETWEEN 2012 AND 2013;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 20:*** *–¢–æ–ø-10 —Å–∞–º—ã—Ö –∫—Ä—É–ø–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –∫–æ–º–ø–∞–Ω–∏–π*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–≥—Ä—É–∑–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç —Ç–∞–∫–∏–µ –ø–æ–ª—è:
- –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏-–ø–æ–∫—É–ø–∞—Ç–µ–ª—è;  
- —Å—É–º–º–∞ —Å–¥–µ–ª–∫–∏;
- –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä—É—é –∫—É–ø–∏–ª–∏;  
- —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –∫—É–ø–ª–µ–Ω–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é;  
- –¥–æ–ª—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç, –≤–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏ –ø—Ä–µ–≤—ã—Å–∏–ª–∞ —Å—É–º–º—É –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –∫–æ–º–ø–∞–Ω–∏—é –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, –æ–∫—Ä—É–≥–ª—ë–Ω–Ω–∞—è –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞.  

–ù–µ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ —Ç–µ —Å–¥–µ–ª–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é. –ï—Å–ª–∏ —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ –∫–æ–º–ø–∞–Ω–∏—é —Ä–∞–≤–Ω–∞ –Ω—É–ª—é, –∏—Å–∫–ª—é—á–∏—Ç–µ —Ç–∞–∫—É—é –∫–æ–º–ø–∞–Ω–∏—é –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.

–û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ —Å—É–º–º–µ —Å–¥–µ–ª–∫–∏ –æ—Ç –±–æ–ª—å—à–µ–π –∫ –º–µ–Ω—å—à–µ–π, –∞ –∑–∞—Ç–µ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫—É–ø–ª–µ–Ω–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–≤—ã–º–∏ –¥–µ—Å—è—Ç—å—é –∑–∞–ø–∏—Å—è–º–∏.  

```sql
SELECT 
    acquiring_c.name AS acquiring_c_name, 
    a.price_amount AS price_amount, 
    acquired_c.name AS acquired_c_name, 
    acquired_c.funding_total AS total_investments, 
    ROUND(a.price_amount / acquired_c.funding_total) AS acquisition_ratio
FROM acquisition AS a
LEFT OUTER JOIN company AS acquiring_c ON a.acquiring_company_id = acquiring_c.id
LEFT OUTER JOIN company AS acquired_c ON a.acquired_company_id = acquired_c.id
WHERE a.price_amount != 0 AND acquired_c.funding_total != 0
ORDER BY price_amount DESC, acquired_c_name ASC
LIMIT 10;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 21:*** *–ö–æ–º–ø–∞–Ω–∏–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ social —Å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º–∏ (2010‚Äì2013)*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–≥—Ä—É–∑–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä—É—é –≤–æ–π–¥—É—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–π –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `social`, –ø–æ–ª—É—á–∏–≤—à–∏–µ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å 2010 –ø–æ 2013 –≥–æ–¥ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –Ω–µ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é. –í—ã–≤–µ–¥–∏—Ç–µ —Ç–∞–∫–∂–µ –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ—Ö–æ–¥–∏–ª —Ä–∞—É–Ω–¥ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è.  

```sql
SELECT c.name,
       EXTRACT(MONTH FROM CAST(fr.funded_at AS date))
FROM company AS c
LEFT OUTER JOIN funding_round AS fr ON fr.company_id = c.id
WHERE c.category_code = 'social'
      AND
      fr.raised_amount != 0
      AND
      EXTRACT(YEAR FROM CAST(fr.funded_at AS date)) BETWEEN 2010 AND 2013;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 22:*** *–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—É–Ω–¥—ã –ø–æ –º–µ—Å—è—Ü–∞–º (2010‚Äì2013)*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–±–µ—Ä–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Å—è—Ü–∞–º —Å 2010 –ø–æ 2013 –≥–æ–¥, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—É–Ω–¥—ã. –°–≥—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ—Ä—É –º–µ—Å—è—Ü–∞ –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –ø–æ–ª—è:  
- –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Ä–∞—É–Ω–¥—ã;  
- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–æ–Ω–¥–æ–≤ –∏–∑ –°–®–ê, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ;  
- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π, –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü;  
- –æ–±—â–∞—è —Å—É–º–º–∞ —Å–¥–µ–ª–æ–∫ –ø–æ –ø–æ–∫—É–ø–∫–∞–º –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ.  

```sql
WITH
investments AS (SELECT EXTRACT(MONTH FROM CAST(fr.funded_at AS date)) AS month, 
                       COUNT(DISTINCT f.id) AS c_cnt
                FROM funding_round AS fr
                LEFT OUTER JOIN investment AS i ON fr.id = i.funding_round_id
                LEFT OUTER JOIN fund AS f ON i.fund_id = f.id
                WHERE EXTRACT(YEAR FROM CAST(fr.funded_at AS date)) BETWEEN 2010 AND 2013
                      AND
                      f.country_code = 'USA'
                GROUP BY month),
acquisitions AS (SELECT EXTRACT(MONTH FROM CAST(acquired_at AS date)) AS month,
                        COUNT(DISTINCT id) AS a_cnt,
                        SUM(price_amount) AS sum_price
                 FROM acquisition
                 WHERE EXTRACT(YEAR FROM CAST(acquired_at AS date)) BETWEEN 2010 AND 2013
                 GROUP BY month)

SELECT i.month, i.c_cnt, a.a_cnt, a.sum_price
FROM investments AS i
LEFT OUTER JOIN acquisitions AS a ON a.month = i.month;
```

-------------------------

üîπ ***–ó–∞–¥–∞–Ω–∏–µ 23:*** *–°—Ä–µ–¥–Ω–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º (2011‚Äì2013)*

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω—é—é —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –¥–ª—è —Å—Ç—Ä–∞–Ω, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Å—Ç–∞—Ä—Ç–∞–ø—ã, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ 2011, 2012 –∏ 2013 –≥–æ–¥–∞—Ö. –î–∞–Ω–Ω—ã–µ –∑–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ–ª–µ. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∑–∞ 2011 –≥–æ–¥ –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É.  

```sql
WITH
inv_2011 AS (SELECT country_code, AVG(funding_total) AS total
             FROM company
             WHERE EXTRACT(YEAR FROM CAST(founded_at AS date)) = 2011
             GROUP BY country_code),
inv_2012 AS (SELECT country_code, AVG(funding_total) AS total
             FROM company
             WHERE EXTRACT(YEAR FROM CAST(founded_at AS date)) = 2012
             GROUP BY country_code),
inv_2013 AS (SELECT country_code, AVG(funding_total) AS total
             FROM company
             WHERE EXTRACT(YEAR FROM CAST(founded_at AS date)) = 2013
             GROUP BY country_code)
SELECT inv_2011.country_code,
       inv_2011.total AS y_2011,
       inv_2012.total AS y_2012,
       inv_2013.total AS y_2013
FROM inv_2011 AS inv_2011
INNER JOIN inv_2012 AS inv_2012 ON inv_2011.country_code = inv_2012.country_code
INNER JOIN inv_2013 AS inv_2013 ON inv_2012.country_code = inv_2013.country_code
ORDER BY y_2011 DESC;
```
